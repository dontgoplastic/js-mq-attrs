{"version":3,"file":null,"sources":["node_modules/camelcase/index.js","src/js-mq-attrs.js"],"sourcesContent":["'use strict';\n\nfunction preserveCamelCase(str) {\n\tvar isLastCharLower = false;\n\n\tfor (var i = 0; i < str.length; i++) {\n\t\tvar c = str.charAt(i);\n\n\t\tif (isLastCharLower && (/[a-zA-Z]/).test(c) && c.toUpperCase() === c) {\n\t\t\tstr = str.substr(0, i) + '-' + str.substr(i);\n\t\t\tisLastCharLower = false;\n\t\t\ti++;\n\t\t} else {\n\t\t\tisLastCharLower = (c.toLowerCase() === c);\n\t\t}\n\t}\n\n\treturn str;\n}\n\nmodule.exports = function () {\n\tvar str = [].map.call(arguments, function (str) {\n\t\treturn str.trim();\n\t}).filter(function (str) {\n\t\treturn str.length;\n\t}).join('-');\n\n\tif (!str.length) {\n\t\treturn '';\n\t}\n\n\tif (str.length === 1) {\n\t\treturn str;\n\t}\n\n\tif (!(/[_.\\- ]+/).test(str)) {\n\t\tif (str === str.toUpperCase()) {\n\t\t\treturn str.toLowerCase();\n\t\t}\n\n\t\tif (str[0] !== str[0].toLowerCase()) {\n\t\t\treturn str[0].toLowerCase() + str.slice(1);\n\t\t}\n\n\t\treturn str;\n\t}\n\n\tstr = preserveCamelCase(str);\n\n\treturn str\n\t.replace(/^[_.\\- ]+/, '')\n\t.toLowerCase()\n\t.replace(/[_.\\- ]+(\\w|$)/g, function (m, p1) {\n\t\treturn p1.toUpperCase();\n\t});\n};\n","import mq from 'js-mq';\nimport camelcase from 'camelcase';\n\nconst prefix                = 'data-mq-';\nconst selector              = '.js-mq';\nconst propValDelimiter      = '--';\n\nconst elMap = new Map();\nconst frameUpdatesAdding = new Map();\nconst frameUpdatesRemoving = new Map();\n\nexport default {\n  registerNewEls: collectElements\n};\n\n\nfunction collectElements() {\n\n  const els = Array.from(document.querySelectorAll(selector));\n\n  if (els.length === 0) return;\n\n  for (const el of els) {\n    if (elMap.has(el) === false) {\n      elMap.set(el, parseElementRules(el));\n    }\n  }\n\n  for (const [el, rules] of elMap.entries()) {\n    for (const rule of rules) {\n      mq.on(rule.mq, () => {\n        scheduleForUpdate(el, 'add', rule);\n      }, () => {\n        scheduleForUpdate(el, 'remove', rule);\n      });\n    }\n  }\n\n}\n\n\nfunction processUpdates() {\n  for (const [el, updates] of frameUpdatesRemoving.entries()) {\n    for (const update of updates) {\n      removeElementRule(update);\n    }\n  }\n  for (const [el, updates] of frameUpdatesAdding.entries()) {\n    for (const update of updates) {\n      addElementRule(update);\n    }\n  }\n\n  frameUpdatesAdding.clear();\n  frameUpdatesRemoving.clear();\n  updating = false;\n}\n\n\nlet updating = false;\nfunction scheduleForUpdate(el, type, rule) {\n\n  const targetMap = type === 'add' ? frameUpdatesAdding : frameUpdatesRemoving;\n\n  if (updating === false) {\n    updating = true;\n    window.requestAnimationFrame(processUpdates);\n  }\n  if (targetMap.has(el) === false) {\n    targetMap.set(el, []);\n  }\n  targetMap.get(el).push(rule);\n}\n\n\nfunction parseElementRules(el) {\n\n  const rules = [];\n  const attrs = el.attributes;\n  const attrsLength = attrs.length;\n\n  for (let i = 0; i < attrsLength; i++) {\n    const attr = attrs[i];\n    const attrName = attr.name;\n\n    if (attrName.startsWith(prefix)) {\n\n      // 'data-mq-xs--class' => ['xs', 'class']\n      const arr = attrName.substring(prefix.length).split(propValDelimiter);\n\n      const mq = arr[0];\n      const property = arr[1];\n      const value = attr.value;\n\n      rules.push({el, mq, property, value});\n    }\n  }\n\n  return rules;\n}\n\ndocument.addEventListener('DOMContentLoaded', collectElements);\n\n\n\n\nfunction parseStyleString(value) {\n  return (value.indexOf(';') === -1 ? [value] : value.split(';'))\n      .map((s) => {\n        if (s) {\n          const arr = s.split(':');\n          return {\n            property: arr[0],\n            value: arr[1]\n          }\n        } else {\n          return null;\n        }\n      })\n      .filter(o => o !== null);\n}\n\nfunction clearElementStyles(el, styles) {\n  applyElementStyles(el, styles, true);\n}\n\nfunction applyElementStyles(el, styles, remove = false) {\n  if (typeof styles === 'string') {\n    styles = parseStyleString(styles);\n  }\n  for (const style of styles) {\n    const propertyCamelCase = camelcase(style.property);\n    el.style[propertyCamelCase] = remove ? '' : style.value;\n  }\n}\n\nfunction removeElementRule({el, mq, property, value}) {\n  switch (property) {\n    case 'style':\n      clearElementStyles(el, value);\n      break;\n    default:\n      el.removeAttribute(property);\n      break;\n  }\n}\nfunction addElementRule({el, mq, property, value}) {\n  switch (property) {\n    case 'style':\n      applyElementStyles(el, value);\n      break;\n    default:\n      el.setAttribute(property, value);\n      break;\n  }\n}"],"names":["prefix","selector","propValDelimiter","elMap","Map","frameUpdatesAdding","frameUpdatesRemoving","collectElements","els","Array","from","document","querySelectorAll","length","el","has","set","parseElementRules","rules","entries","rule","on","mq","processUpdates","updates","update","clear","updating","scheduleForUpdate","type","targetMap","requestAnimationFrame","get","push","attrs","attributes","attrsLength","i","attr","attrName","name","startsWith","arr","substring","split","property","value","addEventListener","parseStyleString","indexOf","map","s","filter","o","clearElementStyles","styles","applyElementStyles","remove","style","propertyCamelCase","camelcase","removeElementRule","removeAttribute","addElementRule","setAttribute"],"mappings":"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"}